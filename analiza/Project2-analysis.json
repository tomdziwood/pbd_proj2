{"paragraphs":[{"text":"spark.sql(\"use etl_airbnb\")","user":"anonymous","dateUpdated":"2020-01-20T22:24:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res7: org.apache.spark.sql.DataFrame = []\n"}]},"apps":[],"jobName":"paragraph_1579552985520_-671635340","id":"20200120-204305_469714747","dateCreated":"2020-01-20T20:43:05+0000","dateStarted":"2020-01-20T22:24:41+0000","dateFinished":"2020-01-20T22:24:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:21374"},{"text":"//spark.sql(\"select * from f_facts, d_time, d_borough, d_room_type where f_facts.id_time = d_time.id and f_facts.id_borough = d_borough.id and f_facts.id_room_type = d_room_type.id\").orderBy(desc(\"rooms_profit\")).show(100)","user":"anonymous","dateUpdated":"2020-01-20T23:45:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579553325387_409178281","id":"20200120-204845_731800927","dateCreated":"2020-01-20T20:48:45+0000","dateStarted":"2020-01-20T23:45:23+0000","dateFinished":"2020-01-20T23:45:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21375","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res86: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id_borough: bigint, id_room_type: bigint ... 16 more fields]\n"}]}},{"text":"//val newDF = df.withColumn(\"ratio\", $\"rooms_rented\" / $\"rooms_rented\") \nvar baseDataSetAnalysisTwo = spark.sql(\"select * from f_facts, d_time, d_borough where f_facts.id_time = d_time.id and f_facts.id_borough = d_borough.id\")","user":"anonymous","dateUpdated":"2020-01-20T23:45:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"baseDataSetAnalysisTwo: org.apache.spark.sql.DataFrame = [id_borough: bigint, id_room_type: bigint ... 14 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579554629755_873333056","id":"20200120-211029_781323264","dateCreated":"2020-01-20T21:10:29+0000","dateStarted":"2020-01-20T23:45:28+0000","dateFinished":"2020-01-20T23:45:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21376"},{"text":"val analysisTwo  = baseDataSetAnalysisTwo.groupBy(\"month\", \"name\", \"city\").agg(avg($\"rooms_rented\")).as(\"avg_rooms_rented\").orderBy(col(\"avg(rooms_rented)\").desc);","user":"anonymous","dateUpdated":"2020-01-20T23:45:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"analysisTwo: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [month: int, name: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579556127074_136123227","id":"20200120-213527_1627983462","dateCreated":"2020-01-20T21:35:27+0000","dateStarted":"2020-01-20T23:45:39+0000","dateFinished":"2020-01-20T23:45:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21377"},{"text":"\nval city = \"Paris\"\n\nanalysisTwo.where(analysisTwo(\"city\") === city).registerTempTable(\"finalAnalysisTwo\");\n\n//analysisTwo.where(analysisTwo(\"city\") === city).show(100);","user":"anonymous","dateUpdated":"2020-01-20T23:45:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579559553787_-74137720","id":"20200120-223233_1838194030","dateCreated":"2020-01-20T22:32:33+0000","dateStarted":"2020-01-20T23:45:54+0000","dateFinished":"2020-01-20T23:45:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21378","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"city: String = Paris\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]}},{"text":"%sql\nselect * from finalAnalysisTwo","user":"anonymous","dateUpdated":"2020-01-20T23:46:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":866,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"month":"string","name":"string","city":"string","avg(rooms_rented)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","style":"stack"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false}},"commonSetting":{},"keys":[{"name":"month","index":0,"aggr":"sum"}],"groups":[{"name":"name","index":1,"aggr":"sum"}],"values":[{"name":"avg(rooms_rented)","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579556126889_648726938","id":"20200120-213526_1125681402","dateCreated":"2020-01-20T21:35:26+0000","dateStarted":"2020-01-20T23:45:58+0000","dateFinished":"2020-01-20T23:46:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21379","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"month\tname\tcity\tavg(rooms_rented)\n12\tButtes-Montmartre\tParis\t290.4835164835165\n6\tButtes-Montmartre\tParis\t285.825\n1\tButtes-Montmartre\tParis\t285.75\n7\tButtes-Montmartre\tParis\t281.7\n4\tButtes-Montmartre\tParis\t280.025\n9\tButtes-Montmartre\tParis\t278.55833333333334\n8\tButtes-Montmartre\tParis\t276.9709677419355\n10\tButtes-Montmartre\tParis\t275.99032258064517\n3\tButtes-Montmartre\tParis\t275.75967741935483\n11\tButtes-Montmartre\tParis\t274.53333333333336\n5\tButtes-Montmartre\tParis\t272.98387096774195\n2\tButtes-Montmartre\tParis\t267.94642857142856\n12\tPopincourt\tParis\t266.7644151565074\n1\tPopincourt\tParis\t265.93548387096774\n6\tPopincourt\tParis\t258.5385964912281\n4\tPopincourt\tParis\t256.9\n3\tPopincourt\tParis\t254.0067911714771\n7\tPopincourt\tParis\t252.95755517826825\n9\tPopincourt\tParis\t250.92105263157896\n5\tPopincourt\tParis\t250.65874363327674\n10\tPopincourt\tParis\t249.77589134125637\n2\tPopincourt\tParis\t249.22932330827066\n8\tPopincourt\tParis\t248.56706281833615\n11\tPopincourt\tParis\t248.2859649122807\n12\tVaugirard\tParis\t183.0203761755486\n1\tVaugirard\tParis\t178.05806451612904\n6\tVaugirard\tParis\t177.89\n7\tVaugirard\tParis\t175.49032258064517\n4\tVaugirard\tParis\t175.32333333333332\n9\tVaugirard\tParis\t174.79333333333332\n10\tVaugirard\tParis\t172.92096774193547\n8\tVaugirard\tParis\t172.7290322580645\n3\tVaugirard\tParis\t172.13709677419354\n5\tVaugirard\tParis\t171.88548387096773\n11\tVaugirard\tParis\t171.73\n2\tVaugirard\tParis\t168.68214285714285\n12\tBatignolles-Monceau\tParis\t166.26182965299685\n6\tBatignolles-Monceau\tParis\t161.91333333333333\n12\tMénilmontant\tParis\t161.2520729684909\n12\tEntrepôt\tParis\t160.78540772532187\n1\tBatignolles-Monceau\tParis\t160.76774193548388\n9\tBatignolles-Monceau\tParis\t159.36666666666667\n7\tBatignolles-Monceau\tParis\t159.3483870967742\n1\tEntrepôt\tParis\t159.0615835777126\n10\tBatignolles-Monceau\tParis\t158.93709677419355\n1\tMénilmontant\tParis\t158.7453310696095\n11\tBatignolles-Monceau\tParis\t158.695\n6\tMénilmontant\tParis\t158.51228070175438\n4\tBatignolles-Monceau\tParis\t158.28\n8\tBatignolles-Monceau\tParis\t157.44516129032257\n6\tEntrepôt\tParis\t157.12575757575758\n3\tBatignolles-Monceau\tParis\t155.90322580645162\n7\tMénilmontant\tParis\t155.75551782682513\n4\tMénilmontant\tParis\t155.1315789473684\n9\tMénilmontant\tParis\t155.06842105263158\n10\tMénilmontant\tParis\t154.47368421052633\n5\tBatignolles-Monceau\tParis\t154.21612903225807\n4\tEntrepôt\tParis\t154.1560606060606\n7\tEntrepôt\tParis\t153.91348973607037\n3\tMénilmontant\tParis\t153.8522920203735\n11\tMénilmontant\tParis\t153.73333333333332\n8\tMénilmontant\tParis\t153.3684210526316\n9\tEntrepôt\tParis\t152.96969696969697\n3\tEntrepôt\tParis\t152.1656891495601\n5\tMénilmontant\tParis\t151.5823429541596\n10\tEntrepôt\tParis\t151.42521994134898\n8\tEntrepôt\tParis\t151.1466275659824\n2\tBatignolles-Monceau\tParis\t150.99285714285713\n5\tEntrepôt\tParis\t150.54545454545453\n11\tEntrepôt\tParis\t150.21515151515152\n2\tMénilmontant\tParis\t149.656015037594\n2\tEntrepôt\tParis\t148.1396103896104\n12\tButtes-Chaumont\tParis\t143.62480376766092\n1\tButtes-Chaumont\tParis\t143.03548387096774\n6\tButtes-Chaumont\tParis\t141.99666666666667\n7\tButtes-Chaumont\tParis\t139.73387096774192\n4\tButtes-Chaumont\tParis\t139.68166666666667\n9\tButtes-Chaumont\tParis\t139.125\n10\tButtes-Chaumont\tParis\t138.58870967741936\n3\tButtes-Chaumont\tParis\t138.14032258064515\n11\tButtes-Chaumont\tParis\t137.735\n8\tButtes-Chaumont\tParis\t137.7306451612903\n5\tButtes-Chaumont\tParis\t137.18870967741935\n2\tButtes-Chaumont\tParis\t136.0375\n12\tPassy\tParis\t123.50785340314137\n12\tTemple\tParis\t121.57167832167832\n1\tTemple\tParis\t118.168458781362\n6\tPassy\tParis\t116.73333333333333\n7\tPassy\tParis\t115.72759856630825\n9\tPassy\tParis\t115.33703703703704\n1\tPassy\tParis\t114.8673835125448\n10\tPassy\tParis\t114.63799283154121\n11\tPassy\tParis\t113.98333333333333\n8\tPassy\tParis\t113.45161290322581\n4\tPassy\tParis\t112.38888888888889\n4\tTemple\tParis\t110.2388888888889\n3\tPassy\tParis\t109.92293906810036\n6\tTemple\tParis\t109.74814814814815\n5\tPassy\tParis\t108.9605734767025\n12\tObservatoire\tParis\t107.43130434782609\n3\tTemple\tParis\t107.31182795698925\n12\tReuilly\tParis\t107.17851239669422\n2\tTemple\tParis\t105.38492063492063\n7\tTemple\tParis\t105.09139784946237\n2\tPassy\tParis\t104.91666666666667\n1\tObservatoire\tParis\t104.90501792114695\n5\tTemple\tParis\t104.89784946236558\n1\tReuilly\tParis\t104.52461799660442\n6\tReuilly\tParis\t104.03684210526316\n6\tObservatoire\tParis\t103.4\n9\tReuilly\tParis\t103.30350877192983\n7\tReuilly\tParis\t102.87266553480475\n10\tReuilly\tParis\t102.70797962648557\n4\tReuilly\tParis\t102.65263157894736\n11\tReuilly\tParis\t102.2\n9\tTemple\tParis\t101.85740740740741\n8\tReuilly\tParis\t101.5704584040747\n4\tObservatoire\tParis\t101.4888888888889\n10\tTemple\tParis\t101.02329749103943\n8\tTemple\tParis\t101.0089605734767\n3\tObservatoire\tParis\t100.96594982078852\n7\tObservatoire\tParis\t100.80286738351255\n9\tObservatoire\tParis\t100.56296296296296\n3\tReuilly\tParis\t100.52971137521223\n5\tReuilly\tParis\t100.2597623089983\n10\tObservatoire\tParis\t99.98028673835125\n5\tObservatoire\tParis\t99.83870967741936\n2\tObservatoire\tParis\t99.70039682539682\n11\tTemple\tParis\t99.53333333333333\n11\tObservatoire\tParis\t99.29444444444445\n8\tObservatoire\tParis\t99.27956989247312\n2\tReuilly\tParis\t96.99248120300751\n12\tOpéra\tParis\t95.01098901098901\n1\tOpéra\tParis\t92.62692847124825\n6\tOpéra\tParis\t91.84347826086956\n12\tGobelins\tParis\t91.32125984251968\n4\tOpéra\tParis\t90.18985507246377\n7\tOpéra\tParis\t89.6984572230014\n6\tGobelins\tParis\t89.27\n9\tOpéra\tParis\t88.90579710144928\n3\tOpéra\tParis\t88.53436185133239\n1\tGobelins\tParis\t88.42903225806451\n10\tOpéra\tParis\t88.04628330995793\n8\tOpéra\tParis\t87.89901823281907\n7\tGobelins\tParis\t87.68225806451613\n5\tOpéra\tParis\t87.62552594670407\n4\tGobelins\tParis\t87.48166666666667\n11\tOpéra\tParis\t87.07101449275362\n9\tGobelins\tParis\t86.96333333333334\n10\tGobelins\tParis\t86.55322580645161\n8\tGobelins\tParis\t86.44193548387096\n3\tGobelins\tParis\t86.12903225806451\n11\tGobelins\tParis\t86.08\n2\tOpéra\tParis\t85.89596273291926\n5\tGobelins\tParis\t85.8241935483871\n12\tPanthéon\tParis\t84.76451077943615\n2\tGobelins\tParis\t83.68928571428572\n1\tPanthéon\tParis\t81.79796264855688\n6\tPanthéon\tParis\t81.60526315789474\n4\tPanthéon\tParis\t79.99122807017544\n5\tPanthéon\tParis\t77.73344651952462\n7\tPanthéon\tParis\t77.4295415959253\n12\tHôtel-de-Ville\tParis\t77.15066225165563\n3\tPanthéon\tParis\t77.0848896434635\n9\tPanthéon\tParis\t76.78070175438596\n12\tBourse\tParis\t76.1630615640599\n8\tPanthéon\tParis\t75.22750424448218\n10\tPanthéon\tParis\t75.11544991511036\n11\tPanthéon\tParis\t74.70350877192982\n2\tPanthéon\tParis\t74.02067669172932\n1\tHôtel-de-Ville\tParis\t73.86078098471987\n12\tLuxembourg\tParis\t72.74385964912281\n1\tBourse\tParis\t71.8251273344652\n4\tHôtel-de-Ville\tParis\t70.17543859649123\n6\tHôtel-de-Ville\tParis\t69.09298245614035\n1\tLuxembourg\tParis\t68.86021505376344\n6\tBourse\tParis\t67.7298245614035\n12\tPalais-Bourbon\tParis\t67.34333333333333\n3\tHôtel-de-Ville\tParis\t67.0679117147708\n6\tLuxembourg\tParis\t66.92037037037036\n4\tBourse\tParis\t66.8280701754386\n5\tHôtel-de-Ville\tParis\t66.74193548387096\n4\tLuxembourg\tParis\t66.16111111111111\n2\tHôtel-de-Ville\tParis\t65.53947368421052\n3\tBourse\tParis\t65.2546689303905\n7\tHôtel-de-Ville\tParis\t65.25297113752123\n7\tBourse\tParis\t65.02546689303905\n5\tLuxembourg\tParis\t64.74910394265233\n12\tÉlysée\tParis\t64.32899628252788\n5\tBourse\tParis\t64.28183361629881\n9\tHôtel-de-Ville\tParis\t64.16315789473684\n1\tPalais-Bourbon\tParis\t63.70967741935484\n2\tBourse\tParis\t63.659774436090224\n3\tLuxembourg\tParis\t63.53763440860215\n9\tBourse\tParis\t63.449122807017545\n8\tBourse\tParis\t63.32597623089983\n10\tHôtel-de-Ville\tParis\t63.06112054329372\n4\tPalais-Bourbon\tParis\t62.97543859649123\n9\tLuxembourg\tParis\t62.94444444444444\n8\tHôtel-de-Ville\tParis\t62.75212224108659\n10\tBourse\tParis\t62.516129032258064\n11\tHôtel-de-Ville\tParis\t62.33157894736842\n7\tLuxembourg\tParis\t62.01075268817204\n11\tBourse\tParis\t61.79298245614035\n6\tPalais-Bourbon\tParis\t61.74912280701754\n10\tLuxembourg\tParis\t61.727598566308245\n2\tLuxembourg\tParis\t60.53174603174603\n5\tPalais-Bourbon\tParis\t60.478777589134125\n11\tLuxembourg\tParis\t60.35\n3\tPalais-Bourbon\tParis\t60.235993208828525\n7\tPalais-Bourbon\tParis\t59.46519524617997\n8\tLuxembourg\tParis\t59.354838709677416\n9\tPalais-Bourbon\tParis\t59.1719298245614\n1\tÉlysée\tParis\t59.1404174573055\n10\tPalais-Bourbon\tParis\t58.74872665534805\n11\tPalais-Bourbon\tParis\t57.91929824561404\n2\tPalais-Bourbon\tParis\t57.66353383458647\n8\tPalais-Bourbon\tParis\t57.24448217317487\n6\tÉlysée\tParis\t56.86078431372549\n4\tÉlysée\tParis\t55.76862745098039\n7\tÉlysée\tParis\t55.00189753320683\n9\tÉlysée\tParis\t54.73137254901961\n8\tÉlysée\tParis\t54.04554079696395\n10\tÉlysée\tParis\t53.8292220113852\n11\tÉlysée\tParis\t53.5078431372549\n3\tÉlysée\tParis\t53.13662239089184\n5\tÉlysée\tParis\t52.47628083491461\n2\tÉlysée\tParis\t51.760504201680675\n12\tLouvre\tParis\t43.67879746835443\n1\tLouvre\tParis\t41.03225806451613\n4\tLouvre\tParis\t39.12166666666667\n6\tLouvre\tParis\t38.635\n3\tLouvre\tParis\t37.693548387096776\n5\tLouvre\tParis\t37.516129032258064\n10\tLouvre\tParis\t37.18387096774194\n2\tLouvre\tParis\t36.82142857142857\n7\tLouvre\tParis\t36.71290322580645\n9\tLouvre\tParis\t36.333333333333336\n11\tLouvre\tParis\t35.61666666666667\n8\tLouvre\tParis\t35.55483870967742\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://project-cluster-m.europe-west3-c.c.bigdata-255415.internal:4040/jobs/job?id=69","http://project-cluster-m.europe-west3-c.c.bigdata-255415.internal:4040/jobs/job?id=70","http://project-cluster-m.europe-west3-c.c.bigdata-255415.internal:4040/jobs/job?id=71"],"interpreterSettingId":"spark"}}},{"text":"var baseDataSetAnalysisThree = spark.sql(\"select * from f_facts, d_time, d_room_type where f_facts.id_time = d_time.id and f_facts.id_room_type = d_room_type.id\");","user":"anonymous","dateUpdated":"2020-01-20T23:47:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"baseDataSetAnalysisThree: org.apache.spark.sql.DataFrame = [id_borough: bigint, id_room_type: bigint ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579553389301_1905392394","id":"20200120-204949_1921068463","dateCreated":"2020-01-20T20:49:49+0000","dateStarted":"2020-01-20T23:47:10+0000","dateFinished":"2020-01-20T23:47:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21380"},{"text":"var analysisThreeWithOccupancy = baseDataSetAnalysisThree.withColumn(\"rooms_occupancy\", $\"rooms_rented\" / $\"rooms_total\") \n//analysisThreeWithOccupancy.show(10);","user":"anonymous","dateUpdated":"2020-01-20T23:47:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579562757186_757445","id":"20200120-232557_811221399","dateCreated":"2020-01-20T23:25:57+0000","dateStarted":"2020-01-20T23:47:18+0000","dateFinished":"2020-01-20T23:47:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21381","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"analysisThreeWithOccupancy: org.apache.spark.sql.DataFrame = [id_borough: bigint, id_room_type: bigint ... 14 more fields]\n"}]}},{"text":"val analysisThree  = analysisThreeWithOccupancy.groupBy(\"year\", \"name\", \"is_superhost\").agg(avg($\"rooms_occupancy\")).as(\"avg_rooms_occupancy\").orderBy(col(\"avg(rooms_occupancy)\").desc);\n//analysisThree.show(100);","user":"anonymous","dateUpdated":"2020-01-20T23:47:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"analysisThree: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [year: int, name: string ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579553694524_608022371","id":"20200120-205454_986214905","dateCreated":"2020-01-20T20:54:54+0000","dateStarted":"2020-01-20T23:47:20+0000","dateFinished":"2020-01-20T23:47:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21382"},{"text":"//val year = \"2018\"\n//analizeThree.where(analysisThree(\"year\") === year).registerTempTable(\"finalAnalysisThree\");\n\n\nanalysisThree.registerTempTable(\"finalAnalysisThree\");","user":"anonymous","dateUpdated":"2020-01-20T23:47:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579563042431_482033644","id":"20200120-233042_457081583","dateCreated":"2020-01-20T23:30:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21383","dateFinished":"2020-01-20T23:47:25+0000","dateStarted":"2020-01-20T23:47:25+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"year":"string","name":"string","is_superhost":"string","avg(rooms_occupancy)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"name","index":1,"aggr":"sum"}],"groups":[{"name":"is_superhost","index":2,"aggr":"sum"},{"name":"year","index":0,"aggr":"sum"}],"values":[{"name":"avg(rooms_occupancy)","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579563441715_1256211364","id":"20200120-233721_1011944605","dateCreated":"2020-01-20T23:37:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22200","text":"%sql\nselect * from finalAnalysisThree","dateUpdated":"2020-01-20T23:47:41+0000","dateFinished":"2020-01-20T23:47:41+0000","dateStarted":"2020-01-20T23:47:28+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\tname\tis_superhost\tavg(rooms_occupancy)\n2018\tEntire home/apt\tfalse\t0.8025934134838288\n2018\tShared room\tfalse\t0.7482736926087432\n2018\tPrivate room\tfalse\t0.7359661149059206\n2018\tEntire home/apt\ttrue\t0.7167002232178873\n2019\tShared room\ttrue\t0.6926960307535548\n2019\tShared room\tfalse\t0.6822225215348098\n2019\tEntire home/apt\tfalse\t0.6698526283942278\n2018\tShared room\ttrue\t0.6691761855313259\n2018\tPrivate room\ttrue\t0.6593729648618637\n2019\tPrivate room\tfalse\t0.6578336590621674\n2020\tShared room\ttrue\t0.6561302681992337\n2019\tPrivate room\ttrue\t0.6124925950102611\n2019\tEntire home/apt\ttrue\t0.5706225801186388\n2020\tPrivate room\tfalse\t0.569982709418364\n2020\tEntire home/apt\ttrue\t0.5644163675538368\n2020\tPrivate room\ttrue\t0.5573536790022735\n2020\tHotel room\ttrue\t0.5375914925357114\n2020\tShared room\tfalse\t0.5369998735680179\n2020\tEntire home/apt\tfalse\t0.5277095542935709\n2019\tHotel room\ttrue\t0.49077044279250165\n2019\tHotel room\tfalse\t0.451489233180114\n2020\tHotel room\tfalse\t0.28040266262254704\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://project-cluster-m.europe-west3-c.c.bigdata-255415.internal:4040/jobs/job?id=72","http://project-cluster-m.europe-west3-c.c.bigdata-255415.internal:4040/jobs/job?id=73","http://project-cluster-m.europe-west3-c.c.bigdata-255415.internal:4040/jobs/job?id=74"],"interpreterSettingId":"spark"}}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-20T23:37:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579563451333_1758614508","id":"20200120-233731_1455635631","dateCreated":"2020-01-20T23:37:31+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22300"}],"name":"Project2","id":"2EXW1E3KW","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}